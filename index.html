<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sistema de agendamento de consultas m√©dicas online">
    <title>Agendamento de Consulta</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Estilos customizados -->
    <link rel="stylesheet" href="./src/css/styles.css">
    <style>
        .index-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="index-bg flex items-center justify-center min-h-screen p-4">

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <p id="toast-message"></p>
    </div>

    <!-- Container Principal -->
    <div class="form-container w-full max-w-2xl bg-white rounded-xl shadow-2xl p-6 md:p-8 space-y-8">

        <!-- Cabe√ßalho Restaurado com Logo -->
        <header class="text-center relative mb-4"> <div class="flex flex-col items-center justify-center">
                <img src="./public/assets/images/UPAE.png" 
                    alt="Logo UPAE" 
                    class="h-16 object-contain mb-3"> 
                <h1 class="text-gray-600 text-sm mt-2">Agendamento UPAE</h1>
            </div>

            <div class="absolute right-0 top-0 h-full flex items-center">
                <button onclick="logout()" class="text-sm text-red-600 hover:text-red-800 flex items-center">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                    </svg>
                    Sair
                </button>
            </div>
            
        </header>

        <!-- Formul√°rio -->
        <form id="agendamento-form" class="space-y-8">

            <!-- Se√ß√£o 1: Dados Pessoais -->
            <div>
                <h2 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-4 flex items-center">
                    <span class="bg-blue-600 text-white rounded-full h-6 w-6 text-sm flex items-center justify-center mr-3">1</span>
                    Dados Pessoais
                </h2>
                <div class="space-y-4">
                    <!-- Nome Completo -->
                    <div>
                        <label for="nome" class="block text-sm font-medium text-gray-700 mb-1">Nome Completo</label>
                        <div class="relative rounded-md shadow-sm">
                            <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                                <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <input type="text" id="nome" name="nome" placeholder="Digite seu nome completo" class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150" required>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- CPF -->
                        <div>
                            <label for="documento" class="block text-sm font-medium text-gray-700 mb-1">CPF</label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <input type="text" id="documento" name="documento" placeholder="000.000.000-00" maxlength="14" class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150" required>
                            </div>
                        </div>

                        <!-- Sexo -->
                        <div>
                            <label for="sexo" class="block text-sm font-medium text-gray-700 mb-1">G√™nero</label>
                            <select id="sexo" name="sexo" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150" required>
                                <option value="" disabled selected>Selecione</option>
                                <option value="homem-cis">Homem Cis</option>
                                <option value="mulher-cis">Mulher Cis</option>
                                <option value="homem-trans">Homem Trans</option>
                                <option value="mulher-trans">Mulher Trans</option>
                                <option value="outro">Outro</option>
                            </select>
                        </div>

                        <!-- Idade -->
                        <div>
                            <label for="idade" class="block text-sm font-medium text-gray-700 mb-1">Idade</label>
                            <input type="number" id="idade" name="idade" min="0" max="150" placeholder="Anos" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150" required>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o 2: Detalhes do Agendamento -->
            <div>
                <h2 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-4 flex items-center">
                    <span class="bg-blue-600 text-white rounded-full h-6 w-6 text-sm flex items-center justify-center mr-3">2</span>
                    Dados da Solicita√ß√£o
                </h2>
                <div class="space-y-4">
                    <!-- Munic√≠pio -->
                    <div>
                        <label for="municipio" class="block text-sm font-medium text-gray-700 mb-1">Munic√≠pio de Resid√™ncia</label>
                        <select id="municipio" name="municipio" class="w-full bg-white px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 transition duration-150" required>
                            <option value="" disabled selected>Selecione</option>
                            <option value="recife">Recife</option>
                            <option value="jaboatao">Jaboat√£o dos Guararapes</option>
                            <option value="olinda">Olinda</option>
                            <option value="caruaru">Caruaru</option>
                            <option value="paulista">Paulista</option>
                            <option value="petrolina">Petrolina</option>
                            <option value="cabo">Cabo de Santo Agostinho</option>
                            <option value="abreu_e_lima">Abreu e Lima</option>
                            <option value="igarassu">Igarassu</option>
                            <option value="camaragibe">Camaragibe</option>
                        </select>
                    </div>

                    <!-- Especialidade -->
                    <div>
                        <label for="especialidade" class="block text-sm font-medium text-gray-700 mb-1">Especialidade Desejada</label>
                        <select id="especialidade" name="especialidade" class="w-full bg-white px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 transition duration-150" required disabled>
                            <option value="" disabled selected>Preencha sexo e idade acima para liberar</option>
                        </select>
                        <p class="text-xs text-gray-500 mt-1">A lista de servi√ßos ser√° filtrada com base no seu perfil (sexo/idade).</p>
                    </div>

                    <!-- Endere√ßo -->
                    <div>
                        <label for="endereco" class="block text-sm font-medium text-gray-700 mb-1">Endere√ßo ou CEP</label>
                        <div class="relative rounded-md shadow-sm">
                            <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <input type="text" id="endereco" name="endereco" placeholder="Digite seu endere√ßo ou CEP" class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150" required>
                        </div>
                        <p class="mt-2 text-xs text-gray-500">Para encontrarmos a unidade de atendimento mais pr√≥xima</p>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o 3: Informa√ß√µes Cl√≠nicas -->
            <div>
                <h2 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-4 flex items-center">
                    <span class="bg-blue-600 text-white rounded-full h-6 w-6 text-sm flex items-center justify-center mr-3">3</span>
                    Informa√ß√µes Cl√≠nicas
                </h2>
                <div class="space-y-4">
                    <!-- N√≠vel de Urg√™ncia/Severidade -->
                    <div>
                        <label for="severity_level" class="block text-sm font-medium text-gray-700 mb-1">
                            N√≠vel de Urg√™ncia
                            <span class="text-gray-500 font-normal text-xs ml-1">(n√£o √© triagem de emerg√™ncia)</span>
                        </label>
                        <select id="severity_level" name="severity_level" class="w-full bg-white px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                            <option value="amarelo" selected>üü° AMARELO - Moderado (acompanhamento, controle)</option>
                            <option value="verde">üü¢ VERDE - N√£o urgente (rotina, preven√ß√£o)</option>
                            <option value="vermelho">üî¥ VERMELHO - Urgente (descompensado, sintom√°tico)</option>
                        </select>
                        <p class="text-xs text-gray-500 mt-1">
                            <strong>Verde:</strong> Consultas de rotina, preven√ß√£o (pode aguardar 30+ dias)<br>
                            <strong>Amarelo:</strong> Acompanhamento, condi√ß√µes controladas (15-30 dias)<br>
                            <strong>Vermelho:</strong> Casos descompensados, sintom√°ticos (prioridade 7-15 dias)
                        </p>
                    </div>

                    <!-- Condi√ß√£o/Motivo da Consulta -->
                    <div>
                        <label for="condition_description" class="block text-sm font-medium text-gray-700 mb-1">
                            Condi√ß√£o / Motivo da Consulta
                        </label>
                        <select id="condition_description" name="condition_description" class="w-full bg-white px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 transition duration-150" disabled>
                            <option value="" disabled selected>Selecione uma especialidade primeiro</option>
                        </select>
                        <p class="text-xs text-gray-500 mt-1">Campo informativo para contexto do m√©dico da UPAE</p>

                        <!-- Campo de texto livre (exibido quando "Outro (especifique)" for selecionado) -->
                        <div id="condition_other_container" class="mt-2 hidden">
                            <input type="text" id="condition_other" name="condition_other" placeholder="Especifique a condi√ß√£o" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                        </div>
                    </div>

                    <!-- Vulnerabilidade Social -->
                    <div>
                        <label for="vulnerability_level" class="block text-sm font-medium text-gray-700 mb-1">
                            Vulnerabilidade Social
                            <span class="text-gray-500 font-normal text-xs ml-1">(opcional)</span>
                        </label>
                        <select id="vulnerability_level" name="vulnerability_level" class="w-full bg-white px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 transition duration-150">
                            <option value="media" selected>M√©dia (padr√£o)</option>
                            <option value="baixa">Baixa (renda est√°vel, moradia fixa, suporte familiar)</option>
                            <option value="alta">Alta (instabilidade habitacional, baixa renda, sem suporte)</option>
                        </select>
                        <p class="text-xs text-gray-500 mt-1">
                            Ajuda a otimizar a aloca√ß√£o: pacientes vulner√°veis com problemas n√£o urgentes tendem a faltar se muito distante
                        </p>
                    </div>

                    <!-- TFD (Tratamento Fora de Domic√≠lio) -->
                    <div>
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" id="tfd_eligible" name="tfd_eligible" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                            <span class="ml-2 text-sm font-medium text-gray-700">
                                Paciente eleg√≠vel para TFD (Tratamento Fora de Domic√≠lio)
                            </span>
                        </label>
                        <p class="text-xs text-gray-500 mt-1 ml-6">
                            Programa do SUS que garante transporte (passagens, ambul√¢ncia, a√©reo) e ajuda de custo (alimenta√ß√£o/pernoite) para tratamento em outro munic√≠pio/estado. Permite aloca√ß√£o em UPAEs mais distantes sem penalidade alta.
                        </p>
                    </div>

                    <!-- Condi√ß√µes Especiais (j√° existentes, agora vis√≠veis) -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 pt-2">
                        <div>
                            <label class="flex items-center cursor-pointer">
                                <input type="checkbox" id="gestante" name="gestante" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                <span class="ml-2 text-sm font-medium text-gray-700">Paciente gestante</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center cursor-pointer">
                                <input type="checkbox" id="deficiencia" name="deficiencia" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                <span class="ml-2 text-sm font-medium text-gray-700">Pessoa com Defici√™ncia (PcD)</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bot√£o de Envio -->
            <div class="pt-4 text-center">
                <button type="submit" class="w-full md:w-auto inline-flex justify-center items-center px-8 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-transform transform hover:scale-105">
                    Enviar Solicita√ß√£o
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                </button>
            </div>

        </form>
    </div>

    <!-- JavaScript -->
    <script>
        // Verificar autentica√ß√£o
        if (sessionStorage.getItem('authenticated') !== 'true') {
            window.location.href = 'login.html';
        }

        // Fun√ß√£o de logout
        function logout() {
            sessionStorage.removeItem('authenticated');
            sessionStorage.removeItem('user_email');
            window.location.href = 'login.html';
        }
    </script>
    <script src="./src/js/config.js"></script>
    <script src="./src/js/maps-integration.js"></script>
    <script src="./src/js/otimizacao.js"></script>
    <script src="./src/js/app.js"></script>
</body>
</html>